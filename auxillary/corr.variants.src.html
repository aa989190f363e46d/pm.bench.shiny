<div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-4886" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=4635350"><img src="https://coursera-profile-photos.s3.amazonaws.com/b3/fce64849e0038fd5d5cf371290ce19/MtCook.jpg" alt="">Marina</a><span class="course-forum-profile-badge">Community TA</span><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4886" name="post-4886" style="vertical-align:middle"><time title="Wednesday, April 23rd 2014, 4:21 pm +03:00" datetime="1398259291">13 days ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text">Now when hard deadline is over, feel free to post and discuss your code. <br>Reading others code is part of learning experience. <br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-active"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count course-forum-votes-positive">6</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4886" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-4892" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=1299214"><img src="https://coursera-profile-photos.s3.amazonaws.com/22/3e4a76ba1d5a8445d622614b678b12/JonPicture.jpg" alt="">Jonathan Fivelsdal</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4892" name="post-4892" style="vertical-align:middle"><time title="Wednesday, April 23rd 2014, 4:37 pm +03:00" datetime="1398260264">13 days ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text">This is what I had for corr<br><br><div>corr &lt;- function(directory, threshold = 0) {</div><div><br> <font color="#333333"> filePath &lt;- paste0(getwd(),"/",directory,"/") </font><br></div><div>  fileNames &lt;- list.files( filePath)</div><div>  </div><div>  fileNameVector &lt;- paste0( filePath,fileNames)</div><div>  <span style="color:rgb(51,51,51);">fileDataList &lt;- lapply(1:length(fileNameVector), function(index) read.csv(fileNameVector[index]))</span></div><div>  <br><span style="color:rgb(51,51,51);">  correlate &lt;- NULL</span></div><div>  </div><div>  for(index in 1:length(fileNameVector ))</div><div>  {</div><div>    if(sum(complete.cases(  fileDataList[[index]])) &gt; threshold) </div><div>    <span style="color:rgb(51,51,51);">{ </span></div><div>      correlate[index] &lt;- cor(fileDataList[[index]]["sulfate"],fileDataList[[index]]["nitrate"],use = "pairwise.complete.obs")   </div><div>    <span style="color:rgb(51,51,51);">} </span></div><div>    <span style="color:rgb(51,51,51);">else{</span></div><div>              <span style="color:rgb(51,51,51);">correlate[index] &lt;- NA</span></div><div>           <span style="color:rgb(51,51,51);">} </span></div><div>   <span style="color:rgb(51,51,51);">}</span></div><div><br></div><div>correlate &lt;-na.omit(correlate)</div><div><span style="color:rgb(51,51,51);">correlate  &lt;- as.numeric(correlate) #converts it back to a numeric vector</span><br></div><div><span style="color:rgb(51,51,51);"><br>return(correlate)</span><br></div><div><span style="color:rgb(51,51,51);"><br>}</span><br></div></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4892" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-4897" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=5702772">Ron Stieger</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4897" name="post-4897" style="vertical-align:middle"><time title="Wednesday, April 23rd 2014, 4:55 pm +03:00" datetime="1398261347">13 days ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text"><pre><code>corr &lt;- function(directory, threshold = 0) {
    flist &lt;- list.files(path = directory, full.names = TRUE)
    goodlist &lt;- subset(complete(directory, 1:length(flist)), nobs &gt; threshold)[,"id"]

    result = numeric(length(goodlist))
    for (i in seq_along(goodlist))
    {
        df &lt;- read.csv(flist[goodlist[i]])
        result[i] = cor(df["sulfate"], df["nitrate"], use = "complete.obs")
    }
    result
}</code></pre>
</div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count course-forum-votes-positive">4</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4897" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"><div><div data-permalink="comment-3174" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=6333673">Troy Le</a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#comment-3174" name="comment-3174" style="vertical-align:middle"><time title="Wednesday, April 23rd 2014, 5:54 pm +03:00" datetime="1398264855">13 days ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text">I like your code Rod, its straight to the point and easy to read. Mine is below, which is not perfect, but a good learning experience nonetheless.<br><br><div>corr &lt;- function(directory, threshold = 0) {</div><div>setwd(directory)</div><div><br></div><div>myfiles &lt;- list.files()</div><div>y &lt;- complete(directory, 1:332)</div><div>x &lt;- y[,2] &gt; threshold</div><div>z &lt;- y[,1][x]</div><div>c &lt;- 1:length(z)</div><div><br></div><div>if (length(z) != 0) {</div><div>    for (i in 1:length(z)) {</div><div>        mydata &lt;- read.csv(myfiles[z[i]])</div><div>      c[i] &lt;- cor(mydata[,"sulfate"], mydata[,"nitrate"], use="complete.obs")</div><div>    }</div><div> </div><div>} else { c &lt;- 0}</div><div><br></div><div>}</div></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#comment-3174" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-4909" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=7141077"><img src="https://coursera-profile-photos.s3.amazonaws.com/77/6d2130bfc511e3890231829bcb8483/Thatya-Ariyaratne_JOW-130808-6025-like-ok.jpg" alt="">Thathya Ariyaratne</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4909" name="post-4909" style="vertical-align:middle"><time title="Wednesday, April 23rd 2014, 5:41 pm +03:00" datetime="1398264085">13 days ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text"><pre>corr &lt;- function(directory, threshold = 0) {<br>  dir &lt;- c(paste(("C:/Users/tariyaratne/Documents/R/"), "specdata", sep=""))<br>  setwd(dir)<br>  x &lt;- list.files(pattern=".csv")<br>  y &lt;- lapply(x, read.table, header = TRUE, sep=",")<br>  z &lt;- do.call(rbind, y)<br>  data &lt;- z[complete.cases(z), ]<br>  comp.df &lt;- complete(y)<br>  s &lt;- subset(comp.df, nobs&gt;threshold)<br>  id &lt;- s[ ,"id"]<br>   vectcr &lt;- NULL<br>      for (i in id) {<br>        subseti &lt;- subset(data, ID==i)<br>        nitratei &lt;- subseti[ ,"nitrate"]<br>        sulfatei &lt;- subseti[ ,"sulfate"]<br>        vectcr &lt;- rbind(vectcr, as.numeric(cor(nitratei, sulfatei)))<br>      }<br>  print(vectcr)<br>}</pre><br><br><br><br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4909" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-4910" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=3235966">Azhaar Hussain</a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4910" name="post-4910" style="vertical-align:middle"><time title="Wednesday, April 23rd 2014, 5:43 pm +03:00" datetime="1398264186">13 days ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text"><div>Here is how did it...<br>corr &lt;- function (dir="specdata",threshold = 0){</div><div>    k&lt;-numeric()</div><div>    id&lt;-1:332</div><div>    filenames&lt;-paste0(formatC(id,width=3,flag="0"),".csv")</div><div>    fullnames&lt;-file.path("specdata",filenames)</div><div>    for (i in 1:length(fullnames)){</div><div>        current_file &lt;- read.csv(fullnames[i],header=TRUE)</div><div>        j &lt;- current_file[complete.cases(current_file),]</div><div>        nobs &lt;- nrow(j)</div><div>        if (nobs &gt; threshold){</div><div>            k&lt;-c(k,cor(j$nitrate,j$sulfate))</div><div>        } </div><div>               </div><div><br></div><div>}</div><div>        </div><div>        k</div><div>}</div></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4910" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-4920" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=3232448">geoffrey anderson</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4920" name="post-4920" style="vertical-align:middle"><time title="Wednesday, April 23rd 2014, 6:00 pm +03:00" datetime="1398265246">13 days ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text">What's to like: No loops were used. The code is short.<br>What's not to like: It took me several hours to research this.<br>Other: There are still some improvements possible. Feel free to improve this code. It's OK with me.<br><br>    require('data.table')<br>    F &lt;- lapply("*.csv", list.files, path=directory, full.names=TRUE)<br>    l &lt;- lapply(F[[1]], read.csv)<br>    ldt &lt;- lapply(l, data.table)    <br>    dt &lt;- rbindlist(ldt)<br>    ret &lt;- dt[<br>        i=!is.na(sulfate) &amp; !is.na(nitrate),<br>        j=list(cor(sulfate,nitrate,use='complete.obs'), .N), <br>        by='ID'][N &gt; threshold]<br>    ret$V1<br><br><br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count course-forum-votes-positive">3</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4920" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"><div><div data-permalink="comment-4596" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=238006">James Eibisch</a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#comment-4596" name="comment-4596" style="vertical-align:middle"><time title="Tuesday, May 6th 2014, 10:12 pm +03:00" datetime="1399403567">an hour ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text">+1 for no loop :)</div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#comment-4596" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-4925" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=2186054"><img src="https://coursera-profile-photos.s3.amazonaws.com/6e/20ca0543928e21724a93591de5e803/Head-Shot.jpg" alt="">Michael Shipman</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4925" name="post-4925" style="vertical-align:middle"><time title="Wednesday, April 23rd 2014, 6:07 pm +03:00" datetime="1398265639">13 days ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text">I know this looks a bit "VBA"ish, but that's what I use at work with MSOffice.  Also, I annotate a lot out of habit to help guide me when I look back at this later. <br><pre>corr &lt;- function(directory, threshold = 0) {<br>        <br>        #Gets and stores the filenames in the specified directory.<br>        FileNames &lt;- list.files(path=directory)<br>        <br>        # Calls "complete" function to get observations per file dataframe.<br>        NumberOfObs &lt;- complete(directory)<br>        <br>        #Creates dataframe with file ID's above threshold value.<br>        ThresID &lt;- subset(NumberOfObs, nobs &gt; threshold)<br>        <br>        #Creates a vector of monitor id's to look up the files.<br>        FileID &lt;- ThresID$id<br>        <br>        #Creates an empty vector CorrVect to store the complied monitor correlations.<br>        CorrVect &lt;- c()<br>                <br>        #If statement checks if there are no files above threshold, otherwise will<br>        # the code will compile the correlation vector.<br>        if (length(FileID) == 0) {<br>                ResultVect &lt;- 0<br>        } else {<br>                ResultVect &lt;- c()<br>              <br>                for (i in FileID){<br>                        #Reads individual monitor data file<br>                        MonData &lt;- read.csv(file=paste(directory, "/", FileNames[i], sep=""),header=TRUE)<br>                        #Retains the complete cases and purges the NA rows from monitor data.<br>                        MonData &lt;- MonData[complete.cases(MonData),]<br>                        filecorr &lt;- cor(MonData["nitrate"],MonData["sulfate"])<br>                        #Compiles the correlation vector with each loop.<br>                        CorrVect &lt;- c(CorrVect, filecorr)<br>                }<br>        }<br>        #Returns the correlation vector out of the function.<br>        CorrVect<br>}<br></pre><br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count course-forum-votes-positive">2</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4925" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-4928" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=1327050"><img src="https://coursera-profile-photos.s3.amazonaws.com/3f/ef411c9d7af4905e60a9cdb8696921/Firefox_wallpaper.png" alt="">Gregory D. Horne</a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4928" name="post-4928" style="vertical-align:middle"><time title="Wednesday, April 23rd 2014, 6:15 pm +03:00" datetime="1398266151">13 days ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text"><br><pre><code>corr &lt;- function(directory, threshold = 0) {<br><br>  correlations = c()<br>  <br>  for (afile in list.files(directory)) {<br>    monitor &lt;- strsplit(afile, "<a>\\.")[[1]][1</a>]<br>    dataset &lt;- read.csv(paste("./", directory, "/", sprintf("%03s", monitor), ".csv", sep=""), TRUE)<br>    if (nrow(dataset[complete.cases(dataset),]) &gt; threshold) {<br>        obs &lt;- dataset[complete.cases(dataset),]<br>        correlations &lt;- append(correlations, cor(obs$sulfate, obs$nitrate))<br>    }<br>  }<br>  <br>  correlations<br>}</code></pre><br>Though I could have simplified it slightly  and eliminated 1 line.<br><br><pre><code>corr &lt;- function(directory, threshold = 0) {<br><br>  correlations = c()<br>  <br>  for (afile in list.files(directory, full.names=TRUE)) {<br>    dataset &lt;- read.csv(afile,TRUE)<br>    if (nrow(dataset[complete.cases(dataset),]) &gt; threshold) {<br>        obs &lt;- dataset[complete.cases(dataset),]<br>        correlations &lt;- append(correlations, cor(obs$sulfate, obs$nitrate))<br>    }<br>  }<br>  <br>  correlations<br><span>}</span><br></code></pre><br><br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4928" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-4951" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=5795600"><img src="https://coursera-profile-photos.s3.amazonaws.com/5e/d05bc0c48311e3aaed8f67c0749273/IMG_20140304_162938_2.jpg" alt="">Arun Balan</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4951" name="post-4951" style="vertical-align:middle"><time title="Wednesday, April 23rd 2014, 8:29 pm +03:00" datetime="1398274186">13 days ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text"><div></div><pre><code>corr &lt;- function(directory, threshold = 0) {
  vectorCorrs &lt;- numeric()
  for (specFile in list.files(directory)){
    tmpData &lt;- read.csv(file.path(directory,specFile))
    tmpData &lt;- tmpData[complete.cases(tmpData),]
    if (nrow(tmpData) &gt; threshold){
      currentCorr &lt;- cor(tmpData[["sulfate"]], tmpData[["nitrate"]])
      vectorCorrs &lt;- append(vectorCorrs, currentCorr)
    }
  }
  vectorCorrs
}<br></code></pre><div></div></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count course-forum-votes-positive">1</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4951" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-4959" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=7078253"><img src="https://coursera-profile-photos.s3.amazonaws.com/6d/743070c7c611e3a48a4d624e45e556/bodensee2013-5.jpg" alt="">Mario Hofer</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4959" name="post-4959" style="vertical-align:middle"><time title="Wednesday, April 23rd 2014, 9:00 pm +03:00" datetime="1398276001">13 days ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text"><pre><code>corr &lt;- function(directory, threshold = 0) {
    corrs = numeric()
    for(curid in 1:332) {
      fn &lt;- paste(directory,"/",formatC(curid,width=3,flag="0"),".csv",sep="")
      data &lt;- read.csv(fn)
      if(sum(complete.cases(data)) &gt; threshold) {
          corrs = c(corrs,cor(data[,2],data[,3],use="complete.obs"))
      }
    }
    corrs
}</code></pre><br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count course-forum-votes-positive">1</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4959" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-4981" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=4326104"><img src="https://coursera-profile-photos.s3.amazonaws.com/63/8fac0e2b89351d1b639eb30a0f7954/me.jpg" alt="">Sean Mantey</a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4981" name="post-4981" style="vertical-align:middle"><time title="Wednesday, April 23rd 2014, 10:34 pm +03:00" datetime="1398281659">13 days ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text"><div>corr &lt;- function(directory, threshold = 0) {</div><div><span style="color:rgb(51,51,51);"> </span><br></div><div>  filenames &lt;- list.files(path=directory)</div><div>  outData &lt;- numeric()</div><div>  </div><div>  for (filename in filenames) {</div><div>    filename2&lt;-paste(directory,"/",filename,sep="")</div><div>    tempData &lt;- read.csv(filename2)</div><div>    tempData2 &lt;- na.omit(tempData)</div><div>    obsCount &lt;- nrow(tempData2)</div><div>    if(obsCount&gt;threshold){</div><div>      outData &lt;- append(outData,cor(tempData2$nitrate,tempData2$sulfate))</div><div>    }</div><div>  }</div><div>  outData</div><div>}</div></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4981" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-4985" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"><a title="Controls" tabindex="0" role="button" aria-haspopup="true" aria-expanded="false" aria-owns="course-forum-post-controls-4985" data-popup="#course-forum-post-controls-4985" data-popup-direction="se" class="course-forum-post-controls-toggle"><i class="icon-cog"><span class="hidden">Controls</span></i></a><div id="course-forum-post-controls-4985" class="course-forum-post-controls-popup hide"><!-- If you have editing rights, you can edit or delete--><a href="javascript:void(0)" class="course-forum-post-edit-link">Edit</a><a href="javascript:void(0)" data-property="deleted" data-value="1" class="course-forum-post-action-link">Delete</a><!-- Only forum moderators --></div></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=143432"><img src="https://coursera-profile-photos.s3.amazonaws.com/89/2f675d5c5db0b0c82ba8500326cbe1/Stained_glass_Tower_of_Ivory.jpg" alt="">Alex Rempel</a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4985" name="post-4985" style="vertical-align:middle"><time title="Wednesday, April 23rd 2014, 10:41 pm +03:00" datetime="1398282086">13 days ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text"><pre><code># PART 3  
corr &lt;- function(directory, threshold = 0) {  

    sapply(Filter( function(x) nrow(x)&gt;threshold  
                 ,lapply(X=paste('specdata',sprintf('%03i.csv',1:332),sep='/')  
                           ,FUN=function(x) na.omit(read.table(x  
                                                        ,header=T  
                                                        ,sep=','  
                                                        ,na.strings='NA'  
                                                        ,stringsAsFactors=FALSE)[c('nitrate','sulfate')])))  
         ,function(x) cor(x[[1]],x[[2]]))  
}</code></pre>
</div><div aria-haspopup="true" aria-expanded="false" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive course-forum-post-vote-disabled"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive course-forum-post-vote-disabled"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4985" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-4987" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=6276077">Stephen A. Wright</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4987" name="post-4987" style="vertical-align:middle"><time title="Wednesday, April 23rd 2014, 10:47 pm +03:00" datetime="1398282478">13 days ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text"><pre><code>corr &lt;- function(directory, threshold = 0) {<br>        vcor = numeric()        <br>        for(file in list.files(directory, pattern = "*.csv", full.names = TRUE)){<br>                temp = na.omit(read.csv(file, header = TRUE))                <br>                if (nrow(temp) &gt; threshold){<br>                        vcor &lt;- rbind(vcor, cor(temp$sulfate, temp$nitrate))<br>                }<br>        }        <br>        vcor        <br>}</code></pre><br><br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4987" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-4999" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=4555390">Lori Kandyba</a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4999" name="post-4999" style="vertical-align:middle"><time title="Wednesday, April 23rd 2014, 11:37 pm +03:00" datetime="1398285444">13 days ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text"><pre><code>corr &lt;- function(directory, threshold = 0) {    <br><br>path &lt;- paste(getwd(), directory, sep="/")       <br>files &lt;- list.files(path, pattern = ".csv", full.names = TRUE) <br><br>corlist &lt;- vector(mode="numeric", length=0)        <br><br>for (i in 1:length(files)) {            <br>    data &lt;- read.csv(files[i])       <br>    x &lt;- sum(complete.cases(data))     <br>    cc&lt;- data[complete.cases(data),]     <br><br>        if (x&gt;threshold) {           <br>            y &lt;- cor(cc[,2], cc[,3])     <br>      corlist &lt;-c(corlist,y)       <br>  }                 <br>}                   <br><br>return(corlist)<br> <br>}                      <br><br></code></pre><br><br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-4999" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5011" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=3156"><img src="https://coursera-profile-photos.s3.amazonaws.com/9d/be8fdf97ee15b06856e6bcadba08c5/head.jpg" alt="">Jan Zegan</a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5011" name="post-5011" style="vertical-align:middle"><time title="Thursday, April 24th 2014, 12:26 am +03:00" datetime="1398288378">13 days ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text"><pre><code>corr &lt;- function(directory, threshold = 0) {
  require(data.table)
  
  results &lt;- c()
  for (file in list.files(directory)){
    .df &lt;- na.omit(fread(file.path(directory, file)))
  
    if(nrow(.df) &gt; threshold){
      results &lt;- c(results, cor(.df$sulfate, .df$nitrate))
    }
    rm(.df)
  }
  results
}</code></pre><br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5011" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5043" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=6660831">Jonathan Gabriel</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5043" name="post-5043" style="vertical-align:middle"><time title="Thursday, April 24th 2014, 2:12 am +03:00" datetime="1398294743">13 days ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text"><div>corr &lt;- function(directory, threshold = 0) {</div><div>  id &lt;- list.files(directory)</div><div>  cv &lt;- c() </div><div>  for (i in id) {</div><div>    data &lt;- read.csv(paste(directory, '/', i, sep=""))</div><div>    comp &lt;- complete.cases(data)</div><div>    sub &lt;- subset(data,comp)</div><div>    if (nrow(sub) &gt; threshold) {</div><div>      cv &lt;- c(cv, cor(sub$sulfate, sub$nitrate))</div><div>    }</div><div>  }</div><div>  cv</div><div>}</div></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5043" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5046" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=76740">yasser Karmaoui idrissi</a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5046" name="post-5046" style="vertical-align:middle"><time title="Thursday, April 24th 2014, 2:21 am +03:00" datetime="1398295301">13 days ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text"><div>corr &lt;- function(directory, threshold = 0){</div><div>        df &lt;- complete(directory,1:332)</div><div>        veto &lt;- logical(length = 332)</div><div>        vetoM &lt;- matrix(veto,332,1)</div><div>        dflog &lt;- df["nobs"]&gt;threshold</div><div>        dflogt &lt;- matrix(dflog,332,1,dimnames = NULL)</div><div>        test &lt;-identical(dflogt,vetoM)</div><div>        if(test){</div><div>                corre &lt;- NULL</div><div>        }else{</div><div>        index &lt;-df[dflog,][,1:2]</div><div>        id1 &lt;- c(index["id"])</div><div>        id &lt;-id1[[1]] </div><div>        names(id)&lt;- NULL</div><div>        wrdir &lt;-getwd()</div><div>        link &lt;- file.path(wrdir,directory)</div><div>        </div><div>        for (i in id ){</div><div>                csvnfil1 &lt;- if(i&lt;10){</div><div>                        paste("0","0",i,".csv",sep="")       </div><div>                }</div><div>                else if(10&lt;= i &amp; i&lt;100){</div><div>                        paste("0",i,".csv",sep="")       </div><div>                }</div><div>                else if(100&lt;=i){</div><div>                        paste(i,".csv",sep="") </div><div>                        </div><div>                }</div><div>                </div><div>                csvnfilc1 &lt;-file.path(link,csvnfil1)</div><div>                </div><div>                csvdata1 &lt;- read.csv(csvnfilc1)</div><div>                csvdatalog &lt;- complete.cases(csvdata1)</div><div>                csvdatac &lt;- csvdata1[csvdatalog,][,1:4]</div><div>                </div><div>                 corre &lt;- if (id[1]== i){</div><div>                        y&lt;-cor(csvdatac["sulfate"],csvdatac["nitrate"])</div><div>                        y[1,1]</div><div>                } </div><div>                else{</div><div>                        z &lt;- cor(csvdatac["sulfate"],csvdatac["nitrate"])</div><div>                        </div><div>                        rbind(corre,z[1,1])</div><div>                        </div><div>                }</div><div>                </div><div>        }}</div><div>        corre</div><div>}</div><div><br><br></div></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5046" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5082" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=1664682"><img src="https://coursera-profile-photos.s3.amazonaws.com/ac/c1012ebf9c20dcb818a458cdd41eb3/IMG_4645.jpg" alt="">john ryan zelling</a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5082" name="post-5082" style="vertical-align:middle"><time title="Thursday, April 24th 2014, 6:48 am +03:00" datetime="1398311319">13 days ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text"><pre><code>corr &lt;- function (
        directory = "specdata",
        threshold = 1 ) {
        
        #function that returns number of complete observations in file
        source("~/Downloads/pollutionmonitordata/complete.R")
        
        #initialize file directory and initialize UNIX pathname to all files
        root &lt;- "~/Downloads/pollutionmonitordata/"
        directory &lt;- paste( root, directory, "/", sep="" )
        setwd( directory )
        filenames &lt;- as.character( list.files() )
        filepaths &lt;- paste( directory, filenames, sep="" )
        
        #initialize complete cases
        filecount &lt;- length( list.files() )
        cases &lt;- complete("specdata", id = 1:filecount)
        
        #initialize cases that meet threshold minimum and set column names
        valid &lt;- cases[ ,2 ] &gt;= threshold
        validcases &lt;- cbind(
                valid1 &lt;- cases[ ,1 ][ valid ],
                valid2 &lt;- cases[ ,2 ][ valid ]
        )
        colnames( validcases ) &lt;- c("id", "nobs")
        
        #initialize new UNIX pathnames using only valid cases
        filenames &lt;- filenames[ validcases[ ,1 ] ]
        filepaths &lt;- paste( directory, filenames, sep="" )
        
        #if no files meet threshold return empty vector
        if( length( filenames ) == 0 ) {
                corrs = c()
                return( corrs )
        }
        
        #initialize vector to store correlations for each file
        corrs &lt;- c()
        
        #loop through UNIX pathnames and store values in corrs
        for( i in seq( filepaths ) ) {
                loadfile &lt;- read.csv( filepaths[ i ] )
                
                #read the sulfate and nitrate values for open file
                sulfate &lt;- loadfile$sulfate
                nitrate &lt;- loadfile$nitrate
                
                #calculate correlation using only complete cases of sulfate, nitrate
                corrs &lt;- c( corrs, cor( 
                                    sulfate[ complete.cases( sulfate, nitrate ) ],
                                    nitrate[ complete.cases( sulfate, nitrate ) ] 
                                        )
                            )
        }
        
        return( corrs )
}
</code></pre><div><br></div><br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5082" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5083" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=243267"><img src="https://coursera-profile-photos.s3.amazonaws.com/e2/b37ca0cf6f11e3a1d02773fd8ee262/rsz_thinking_cat4.jpg" alt="">timothy235</a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5083" name="post-5083" style="vertical-align:middle"><time title="Thursday, April 24th 2014, 6:53 am +03:00" datetime="1398311601">13 days ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text"><div>corr &lt;- function(directory, threshold = 0) {</div><div><br></div><div>    # store the correlations in the vector result</div><div>    result &lt;- c()</div><div><br></div><div>    for (i in 1:332) {</div><div><br></div><div>        # convert the file number to character and prepend zeroes if necessary</div><div>        filename &lt;- if (i &lt; 10) {</div><div>            paste("00", as.character(i), sep = "")</div><div>        } else if (i &lt; 100) {</div><div>            paste("0", as.character(i), sep = "")</div><div>        } else {</div><div>            as.character(i)</div><div>        }</div><div><br></div><div>        # assume specdata is a subdirectory of the present working directory</div><div>        filepath &lt;- paste(c(directory, "/", filename, ".csv"), collapse = "")</div><div><br></div><div>        # put new data in matrix</div><div>        dataframe &lt;- read.csv(filepath)</div><div>        cmpltcases &lt;- complete.cases(dataframe)</div><div>        numcases &lt;- sum(cmpltcases)</div><div><br></div><div>        if (numcases &gt; threshold) {</div><div>            df &lt;- subset(dataframe, cmpltcases)</div><div>            corr &lt;- cor(df$nitrate, df$sulfate)</div><div>            result &lt;- c(result, corr)</div><div>        }</div><div>    }</div><div>    </div><div>    result</div><div>}</div><div><br></div></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5083" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5086" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=3213201">William B Piggot</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5086" name="post-5086" style="vertical-align:middle"><time title="Thursday, April 24th 2014, 7:01 am +03:00" datetime="1398312079">13 days ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text"><pre><code>corr &lt;- function(directory, threshold = 0){
  cases &lt;- complete("~/Desktop/R Files/specdata", 1:332)
  newDF &lt;- cases[cases[2] &gt; threshold, c(1,2)]
excid &lt;-newDF$id
corVect &lt;- c()
for (i in seq_along(excid)){
  filename &lt;- paste(directory, "/", sprintf("%03d", as.numeric(excid[i])), ".csv", sep = "")
  my_data &lt;- read.csv(filename)
  clean_data &lt;- my_data[complete.cases(my_data[,1:4]),]
  a &lt;- cor(clean_data[, "nitrate"], clean_data[, "sulfate"])
  corVect &lt;- append(corVect, a)}
  return(corVect)
}</code></pre><br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5086" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5127" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=521654"><img src="https://coursera-profile-photos.s3.amazonaws.com/bf/998cd0d34c11fd2115d772d9c4793a/ammar-pic.jpg" alt="">Ammar Raja</a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5127" name="post-5127" style="vertical-align:middle"><time title="Thursday, April 24th 2014, 12:17 pm +03:00" datetime="1398331057">12 days ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text"><div>It is as simple as this. I couldn't complete it before the deadline, but still feeling good that I atleast completed it. I have seen many other solutions which seem complex, if you are looking for the simplest solution to Assignment 1, part 3, this is the one. Give it a go, gives all the results you want in a whisker.<br><br><pre><code></code></pre><br>corr &lt;- function(directory, threshold=0) {</div><div>                </div><div>              result &lt;- numeric(0)              </div><div>   </div><div><br></div><div>                for(i in 1:332) {</div><div>                                x &lt;- list.files()[i];</div><div>                        csvfiledata &lt;- read.csv(x)</div><div>                        csvfilecompdata &lt;- csvfiledata[complete.cases(csvfiledata),]</div><div>                        count &lt;- nrow(csvfilecompdata)</div><div><br></div><div>                        if(count &gt; threshold) {</div><div>                                result &lt;- append(result, cor((csvfilecompdata$nitrate), (csvfilecompdata$sulfate)))</div><div>                        }</div><div><span style="color:rgb(51,51,51);">                }</span><br></div><div>result</div><div>}</div><div><br></div></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count course-forum-votes-positive">1</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5127" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5130" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=7026658">TANIA CAMARA ALONSO</a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5130" name="post-5130" style="vertical-align:middle"><time title="Thursday, April 24th 2014, 12:51 pm +03:00" datetime="1398333090">12 days ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text"><div>corr &lt;- function(directory, threshold = 0) {</div><div>  ## 'directory' is a character vector of length 1 indicating</div><div>  ## the location of the CSV files</div><div>  </div><div>  ## 'threshold' is a numeric vector of length 1 indicating the</div><div>  ## number of completely observed observations (on all</div><div>  ## variables) required to compute the correlation between</div><div>  ## nitrate and sulfate; the default is 0</div><div><br></div><div>  res &lt;- numeric()</div><div>  nobs &lt;- complete("specdata")</div><div><br></div><div>  ## Return a numeric vector of correlations</div><div>  #dataF &lt;- data.frame()</div><div>  #i &lt;- 1</div><div>  for (i in 1:length(nobs[,2])) {</div><div>      if (nobs[i,2] &gt;= threshold[1]) {</div><div>        aux &lt;- read.csv(paste(getwd(),"/",directory[1],"/",substr(paste(as.character(nobs[i,1]+1000),".csv", sep=""),2,8), sep=""))</div><div>        inp &lt;- cbind(aux[,2],aux[,3])</div><div>        good &lt;- complete.cases(inp)</div><div>        corr &lt;- cor(inp[good,])</div><div>        res[i] &lt;- corr[1,2]</div><div>        #i&lt;- i+1</div><div>    </div><div>      }</div><div>  }</div><div>  bad &lt;- is.na(res)</div><div>  out &lt;- res[!bad]</div><div>  return(out)</div><div>}</div></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5130" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5140" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=3775876">Matthew Grant</a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5140" name="post-5140" style="vertical-align:middle"><time title="Thursday, April 24th 2014, 1:26 pm +03:00" datetime="1398335163">12 days ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text"><pre><code>corr &lt;- function(directory, threshold = 0) {<br>        data &lt;- NULL<br>        corr.list &lt;- NULL<br>        for(i in 1:332) {<br>                data &lt;- read.csv(paste0(getwd(), "/", directory, "/", sprintf("%03d", i), ".csv")) <br>                cc &lt;- data[complete.cases(data),]<br>                if(nrow(cc) &gt; threshold) {<br>                        corr.list &lt;- append(corr.list, cor(cc$sulfate, cc$nitrate))<br>                }<br>        }                 <br>                return(corr.list)<br>}</code></pre><br><br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5140" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5147" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=1284442"><img src="https://coursera-profile-photos.s3.amazonaws.com/7f/a25f4342d1380a3bc680d287b77735/a_53c5006b.jpg" alt="">Matvey Roshchin</a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5147" name="post-5147" style="vertical-align:middle"><time title="Thursday, April 24th 2014, 2:43 pm +03:00" datetime="1398339827">12 days ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text"><pre><code>corr &lt;- function(directory, threshold = 0) {
    # create list of the data files
    data_ls &lt;- list.files(paste(getwd(), '/', directory, sep=''))
    # create an empty vector to store output
    corr_data &lt;- vector(mode = 'numeric', length = 0)
    # find the number of complete cases and add to output if &gt; threshold
    for (i in 1:length(data_ls)){
        #load CSV file
        csv &lt;- read.csv(paste(directory, '/', data_ls[i], sep = ''))
        #subset complete cases only
        csv_full &lt;- csv[!is.na(csv$sulfate) &amp; !is.na(csv$nitrate),]
        #measure number of complete cases and choose action
        if (dim(csv_full)[1] &gt; threshold){
            #correlation coefficient between sulfate and nitrate
            corr_data &lt;- append(corr_data, cor(csv_full$sulfate, csv_full$nitrate))
        }
    }
    return(corr_data)
}</code></pre><br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5147" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5157" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=5238644">Dinesh Kumar SRB</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5157" name="post-5157" style="vertical-align:middle"><time title="Thursday, April 24th 2014, 3:32 pm +03:00" datetime="1398342729">12 days ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text"><pre><code>corr &lt;- function (directory, threshold = 0) {        <br>        AF &lt;-  list.files(directory, pattern="*.csv")<br>        length &lt;- length(AF)<br>        total &lt;- as.numeric()         <br>        for (i in 1:length) {                <br>                readfile &lt;- paste(directory, AF[i], sep = "/")<br>                x &lt;- read.csv(readfile)<br>                no_nas &lt;- na.omit(x)<br>                total_obs &lt;- nrow(no_nas)<br>                if (total_obs &gt; threshold) {<br>                        sulfate &lt;- no_nas[, "sulfate"]<br>                        nitrate &lt;- no_nas[, "nitrate"]<br>                        correlation &lt;- cor (sulfate, nitrate)<br>                        finalcor &lt;- round (correlation, digits = 4)<br>                        total &lt;- c (total, finalcor)<br>                }              <br>        }<br>        total<br>} </code></pre><br><br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5157" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5170" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=7239984">Marcelo</a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5170" name="post-5170" style="vertical-align:middle"><time title="Thursday, April 24th 2014, 5:37 pm +03:00" datetime="1398350247">12 days ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text">There are some good ones here. Mine is more pedantic and amateurish:<br><pre>corr &lt;- function(directory, threshold = 0) {<br>        mydir &lt;- paste(getwd(),directory,sep="/")<br>        setwd(mydir)        <br>        filelist &lt;- list.files()<br>        mydata &lt;- complete(directory)         #outputs a data frame<br>        pass &lt;- mydata[,2] &gt;= threshold &amp; mydata[,2]!=0  <br>                                #skip where there are no valid observations (e.g. "275.csv")<br>        <br>        passid &lt;- mydata[pass,1]              #this gives the list of IDs that pass the test<br>        okfiles &lt;- filelist[passid]           #these are the filenames<br>        mycorrs &lt;- numeric()                  #initialize the vector<br>        for(i in okfiles){<br>                singlefile &lt;- read.csv(i)<br>                c1 &lt;- singlefile[,2]<br>                c2 &lt;- singlefile[,3]<br>                myres &lt;- cor(c1,c2,use="complete.obs")  #ignores NA values<br>                mycorrs &lt;- c(mycorrs,myres)   #error in "275.csv" and others<br>                                              #see complete.R output where =0<br>        }<br>        mycorrs   #output<br>}<br><br></pre><br><br><br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5170" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5193" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=4123451">Edward Steven Seymour</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5193" name="post-5193" style="vertical-align:middle"><time title="Thursday, April 24th 2014, 8:05 pm +03:00" datetime="1398359116">12 days ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text">Here's mine:<br><pre><code>corr &lt;- function(directory, threshold = 0) {
  correlations &lt;- vector()
  comp &lt;- complete(directory)
  
  for (i in subset(comp, nobs &gt;= threshold)[["id"]]) {
    sensor &lt;- read.csv(sprintf("%s/%03d.csv", directory, i))
    correlations &lt;- append(correlations,
                           cor(sensor$sulfate, sensor$nitrate, use = "na.or.complete"))
  }
  
  correlations
}</code></pre><br><br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5193" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5212" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=6514356">Bruno Gonçalves</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5212" name="post-5212" style="vertical-align:middle"><time title="Thursday, April 24th 2014, 9:41 pm +03:00" datetime="1398364886">12 days ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text">Hi.<br>Here is mine. Any comments and suggestions appreciated.<br><br><pre><code>corr &lt;- function(directory, threshold = 0) {<br>      ## 'directory' is a character vector of length 1 indicating<br>      ## the location of the CSV files<br><br>      ## 'threshold' is a numeric vector of length 1 indicating the<br>      ## number of completely observed observations (on all<br>      ## variables) required to compute the correlation between<br>      ## nitrate and sulfate; the default is 0<br><br>      ## Return a numeric vector of correlations<br><br>      #setup &amp; initialize<br>      path &lt;- paste("./",directory,sep="") #build the path to data files<br>      files &lt;- dir(path,full.names=TRUE) #store all available files<br><br>      #loop and compute complete sets<br>      output&lt;-NULL<br>      for (file in files){<br>            main_data &lt;- read.csv(file)<br>            has_data &lt;-complete.cases(main_data)<br>            clean_data &lt;- main_data[has_data,]<br>            if (sum(has_data)&gt;threshold){<br>                  x&lt;-clean_data[["sulfate"]]<br>                  y&lt;-clean_data[["nitrate"]]<br>                  d&lt;-cor(x,y)<br>                  output&lt;-c(output,d)<br>            }<br>      }<br>      if (is.null(output)){<br>            output &lt;-as.numeric(output)<br>      } else {<br>            output &lt;- output<br>      }<br>}</code></pre><br>Regards.<br><br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5212" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5257" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=6700202">Patrick Bolbrinker</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5257" name="post-5257" style="vertical-align:middle"><time title="Friday, April 25th 2014, 1:07 am +03:00" datetime="1398377223">12 days ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text"><div>source("complete.R")<br>correlations  &lt;- rep(0, times = length(id))<br><br>corr &lt;- function(directory, threshold = 0) {</div><div>        count &lt;- 1:332<br></div><div>    </div><div>        complete &lt;- complete(directory, count)</div><div>        complete &lt;- subset(complete, nobs &gt; threshold, drop = TRUE)</div><div>        id &lt;- complete$id</div><div>  </div><div>        if (length(id) &gt; 0) {</div><div>  </div><div>          filenames &lt;- ifelse(id &lt;= 9, paste("00", id, ".csv", sep = ""), ifelse(id &lt;= 99, paste("0", id, ".csv", sep = ""),</div><div>                        paste(id, ".csv", sep = "")))</div><div>  </div><div>          filenames &lt;- paste(directory, "/", filenames, sep="")</div><div>  </div><div>          selection &lt;- lapply(filenames, read.csv)</div><div>         </div><div>          for (i in 1:length(id)) {</div><div>           </div><div>              correlations[i] &lt;- cor(selection[[i]][2],selection[[i]][3], use = "pairwise.complete.obs")</div><div><br></div><div>          }</div><div>  </div><div>        correlations</div><div>  </div><div>        } else {</div><div>    </div><div>        correlations &lt;- as.numeric(NULL)</div><div>    </div><div>        }</div><div>}</div></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5257" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5264" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=945613">James B Taylor</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5264" name="post-5264" style="vertical-align:middle"><time title="Friday, April 25th 2014, 3:17 am +03:00" datetime="1398385063">12 days ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text"><div>corr &lt;- function(directory, threshold = 0) {</div><div>  </div><div>  ##get all the files in the directory containing data</div><div>  currentPath &lt;- getwd()</div><div>  folderPath &lt;- paste(currentPath,"/",directory,sep='')</div><div>  files &lt;- c(list.files(folderPath))</div><div>  </div><div>  ##create return vector preset to the "none pass the threshold" value.</div><div>  thisCor &lt;- vector()</div><div>  thisCor &lt;- numeric()  </div><div>  selectedData &lt;- data.frame()</div><div>  </div><div>  ##read in each file and check if it meets the threshold, if so add column with correlation</div><div>  for (i in files){</div><div>    selectedData &lt;- read.csv(paste(folderPath,"/",i,sep=''))</div><div>    completeObs &lt;- selectedData[complete.cases(selectedData),]</div><div>    </div><div>    ##add correlation between sulphate and nitrate if it meets the threshold</div><div>    if (nrow(completeObs) &gt;= threshold){     </div><div>      thisCor &lt;- c(thisCor,cor(completeObs$sulfate,completeObs$nitrate))     </div><div>    }</div><div>  }</div><div><br></div><div>  return (thisCor)</div></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5264" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5341" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=467032">anhhh.11</a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5341" name="post-5341" style="vertical-align:middle"><time title="Friday, April 25th 2014, 5:26 pm +03:00" datetime="1398435997">11 days ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text">#My code<br>corr &lt;- function(directory, threshold = 0,id=1:332) {<br> completeData &lt;- complete(directory,id)<br>  dataIdChoosed &lt;- subset(completeData,nobs&gt;threshold)[,"id"]<br>  corrVector = c()<br>  for (i in dataIdChoosed){<br>    idPadded &lt;- str_pad(i,width=3,pad="0",side="left")<br>    filename &lt;- paste(directory,paste(idPadded,".csv",sep=""),sep="/")<br>    pollutantData &lt;- read.csv(filename,header=TRUE)<br>    corrVector = c(corrVector,cor(pollutantData$nitrate<br>                                       ,pollutantData$sulfate<br>                                       ,use="pairwise.complete.obs"))<br>  }<br>  corrVector<br>}<br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5341" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5493" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=3142216">Biswajit Dutta Baruah</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5493" name="post-5493" style="vertical-align:middle"><time title="Saturday, April 26th 2014, 7:04 pm +03:00" datetime="1398528250">10 days ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text">This is my code. But some of the succint code submitted by others is wonderful. Week 3 videos also are very helpful in doing the same.<div><br></div><div><pre>corr &lt;- function(directory, threshold = 0) {
  list &lt;- dir(directory, full.names = TRUE)
  f.data &lt;- function(n) {
    for(file in n) {
      if(!exists("p.data")){
        p.data &lt;- read.csv(file, header = TRUE)
      }
      else if(exists("p.data")) {
        temp.data &lt;- read.csv(file, header = TRUE)
        p.data &lt;- rbind(p.data, temp.data)
        rm(temp.data)
      }
    }
    p.data
  }
  pollutant.data &lt;- f.data(list)
  good &lt;- function(i) {
    subset.i &lt;- subset(pollutant.data, ID == i)
    sum(complete.cases(subset.i))
  }
  id &lt;- 1:332
  corr &lt;- as.numeric()
  for(i in id) {
    if(good(i) &gt; threshold){
      subset.i &lt;- subset(pollutant.data, ID == i)
      corr.i &lt;- cor(subset.i$sulfate, subset.i$nitrate, use = "pairwise.complete.obs")
      corr &lt;- c(corr,corr.i)
      rm(corr.i)
    }
  }
  corr
}<code></code></pre><br><br><div><br></div><div><br></div></div></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5493" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5541" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=6124789"><img src="https://coursera-profile-photos.s3.amazonaws.com/50/2645d087b611e3a1fae537543f7230/meondecember19th2013.jpg" alt="">Patrick McGovern</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5541" name="post-5541" style="vertical-align:middle"><time title="Sunday, April 27th 2014, 1:39 am +03:00" datetime="1398551991">10 days ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text"><div>corr &lt;- function(directory, threshold = 0) {</div><div><span style="color:rgb(51,51,51);">    myData &lt;- complete(directory);    </span><br></div><div>    myThresholdData &lt;- subset(myData, nobs &gt;= threshold)</div><div>    result &lt;- numeric(0)</div><div>    for (i in 1:nrow(myThresholdData))</div><div>    {</div><div>        if (nrow(myThresholdData) == 0) {break}</div><div>        fileName &lt;- paste(directory, "/", padid(myThresholdData$id[i]), ".csv", sep="")</div><div>        tempData &lt;- read.csv(fileName)</div><div>        tempData &lt;- na.exclude(tempData)</div><div>        result &lt;- append(result, cor(tempData$sulfate, tempData$nitrate))</div><div>    }</div><div>    ##round(result, digits=5)</div><div>    result</div><div>}</div><div><br><br></div></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5541" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5545" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=1512609"><img src="https://coursera-profile-photos.s3.amazonaws.com/38/9984bd3cf152ea823d58dc2468eebe/DSCF1216kmmm.jpg" alt="">Dipanjan Sarkar</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5545" name="post-5545" style="vertical-align:middle"><time title="Sunday, April 27th 2014, 2:32 am +03:00" datetime="1398555129">10 days ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text"><pre><code>corr &lt;- function(directory, threshold = 0) {

  files &lt;- list.files(directory)
  cases &lt;- complete(directory)
  
  file_nums &lt;- subset(cases,nobs &gt; threshold,id)
  file_nums &lt;- as.vector(t(file_nums))
  
  corr_vector &lt;- numeric()
  
  for (i in file_nums){
    file_name &lt;- paste(getwd(),"/",directory,"/",files[i], sep="")
    f &lt;- read.csv(file_name)
    complete_data &lt;- complete.cases(f)
    f &lt;- f[complete_data,]
    
    x &lt;- f[['sulfate']]
    y &lt;- f[['nitrate']]
    corr_vector &lt;- c(corr_vector, cor(x,y))
  }
  corr_vector
}</code></pre><br>This makes use of the complete function which we implemented before this.<br><br><pre><code>complete &lt;- function(directory, id = 1:332) {
  
  ## Return a data frame of the form:
  ## id nobs
  ## 1  117
  ## 2  1041
  ## ...
  ## where 'id' is the monitor ID number and 'nobs' is the
  ## number of complete cases
  
  files &lt;- list.files(directory)
  df &lt;- data.frame(id=NA,nobs=NA)
  
  count &lt;- 1
  for (i in id){
    file_name &lt;- paste(getwd(),"/",directory,"/",files[i], sep="")
    f &lt;- read.csv(file_name)
    cases &lt;- complete.cases(f)
    df[count,] &lt;- rbind(c(i,sum(cases)))
    count &lt;- count + 1
  }
  df
}</code></pre><br><br><br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5545" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5859" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=5323114"><img src="https://coursera-profile-photos.s3.amazonaws.com/34/2c9fa0691b11e3bd14eb7f3ec6afb7/Asheshwor_20120802_squareBw.jpg" alt="">Asheshwor Man Shrestha</a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5859" name="post-5859" style="vertical-align:middle"><time title="Tuesday, April 29th 2014, 8:46 am +03:00" datetime="1398750396">8 days ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text">Here's mine,<br><pre><code>corr &lt;- function(directory, threshold = 0) {
  ## 'directory' is a character vector of length 1 indicating
  ## the location of the CSV files
  
  ## 'threshold' is a numeric vector of length 1 indicating the
  ## number of completely observed observations (on all
  ## variables) required to compute the correlation between
  ## nitrate and sulfate; the default is 0
  
  #count number of files in the directory
  filecount &lt;- length(list.files(directory, full.names=TRUE, pattern=".csv"))
  #extract complete cases using complete function from **Part 2** exercise
  pmcomplete &lt;- data.frame(complete("specdata", 1:filecount))
  #extract cases with observations greater than the threshold
  pmpass &lt;- pmcomplete[pmcomplete$nobs &gt; threshold,]
  #ged ids of monitors passing the threshold
  passid &lt;- pmpass$id
  #file format
  passfileformat &lt;- paste0(directory, "/%03d", ".csv")
  #make file name strings from supplid ids
  passfiles &lt;- c(sprintf(passfileformat, passid))
  #apply correlation function to the variables for each station
  passcor &lt;- sapply(passfiles, function(xfile) {
    #read the file for each station
    this.file &lt;- read.csv(xfile, na.strings=c("NA"), stringsAsFactors=FALSE)
    #extract complete cases
    completeonly &lt;- this.file[complete.cases(this.file),]
    cor &lt;- if(is.null(completeonly)) {
      0 #retun 0
    } else {
      round(cor(completeonly$sulfate, completeonly$nitrate), 10) #return rounded values
    }
  }, USE.NAMES = FALSE)
  if (length(passcor) == 0) return(numeric(length=0)) else
    return(passcor)
}</code></pre><br><br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5859" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-5936" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=3684443">Charles Skelton</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5936" name="post-5936" style="vertical-align:middle"><time title="Wednesday, April 30th 2014, 1:31 am +03:00" datetime="1398810698">7 days ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text"><div>corr &lt;- function(directory, threshold = 0) {</div><div>        corrs&lt;-numeric(0)</div><div>        filenames = list.files(path = directory, pattern = "*.csv")</div><div>        for(filename in filenames){</div><div>                data &lt;- read.csv(file.path(directory, filename))</div><div>                data &lt;- na.omit(data)</div><div>                if(nrow(data)&gt;=threshold){</div><div>                  corrs&lt;-c(corrs,cor(data[,"sulfate"],data[,"nitrate"]))  </div><div>                }        </div><div>        }</div><div>        na.omit(corrs)</div><div>}</div><div><br></div></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-5936" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-6854" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=7149494">Kenneth Crocken</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-6854" name="post-6854" style="vertical-align:middle"><time title="Tuesday, May 6th 2014, 8:47 am +03:00" datetime="1399355220">14 hours ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text"><pre><code>corr &lt;- function(directory, threshold = 0) {
    magic &lt;- c()
    files &lt;- list.files(path=directory, full.names=T)
    
    for ( fileName in files){
        allData &lt;- read.csv(fileName, header=TRUE)
        completeCases &lt;- dim(allData[complete.cases(allData),])[1]
        if (completeCases &gt; threshold){       
            correlation &lt;- cor(allData$sulfate , allData$nitrate, use="complete.obs")
            magic&lt;- c(magic, correlation)
        }
    } 
    return(magic)   
}<br></code></pre></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-6854" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-6855" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=2763088">Ritu</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-6855" name="post-6855" style="vertical-align:middle"><time title="Tuesday, May 6th 2014, 8:56 am +03:00" datetime="1399355773">14 hours ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text"><div><strong>Here is my corr.R </strong><br><br>corr  &lt;- function ( directory, threshold=0 ) {</div><div>  </div><div>  if(directory != "specdata") {</div><div>    stop("No such directory, try specdata")</div><div>  } </div><div>  </div><div>  m &lt;- vector(mode="numeric", length=0)</div><div>  z = 0 </div><div>  </div><div>  for (i in 1:332){   #Start for loop</div><div>    </div><div>    fname &lt;- sprintf("%s/%03d.csv", directory, i)</div><div>    temp &lt;- read.csv(fname, header=TRUE)</div><div>    neat &lt;-  temp[complete.cases(temp),]</div><div>    </div><div>    comp &lt;- nrow(neat)    #number of complete cases.</div><div>    if(comp&gt;threshold){ </div><div>    z = z+1</div><div>    m[z] &lt;- round(cor(neat$sulfate, neat$nitrate),4) <br></div><div>    }</div><div>  }         ##End of for loop.</div><div>  </div><div>      return (m) </div><div>  </div><div>} # End of function.</div><div><br></div><div> cr &lt;- corr("specdata" )                # this is function being called. </div><div> summary(cr)</div><div> length(cr)</div><div><br></div></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-6855" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-6890" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=3138909"><img src="https://coursera-profile-photos.s3.amazonaws.com/ce/18c054357d0a96f8d42f6772415abc/JB_AW008.jpg" alt="">Jammi N Rao</a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-6890" name="post-6890" style="vertical-align:middle"><time title="Tuesday, May 6th 2014, 6:52 pm +03:00" datetime="1399391571">4 hours ago</time> <span class="icon-link"></span></a></h5></div><div style="margin-left: 0px;" dir="auto" class="course-forum-post-text">This is the way I did it: I saved the corr.R file along with all the csv files inm the same specdata directory, so in effect the directory argument to corr() is redundant. it reads all the csv files in the default working directory.I could equally have had 1:332 in the for loop, <br><div></div><pre><code></code></pre><div><code>#corr.R</code></div><code></code><div><code>corr &lt;- function(directory, threshold=0) {</code></div><code></code><div><code>  files &lt;- list.files(pattern="*.csv")</code></div><code></code><div><code>  corvec &lt;- numeric()</code></div><code></code><div><code>  for (i in 1:length(files)) {</code></div><code></code><div><code>    thisfile &lt;- read.csv(files[i])</code></div><code></code><div><code>    if (length(which(complete.cases(thisfile))) &gt; threshold){</code></div><code></code><div><code>      corvec &lt;- c(corvec, cor(thisfile$sulfate,thisfile$nitrate,use="complete.obs"))</code></div><code></code><div><code>    <span style="color:inherit;">} # endif</span></code></div><code></code><div><code>  } # end of for loop</code></div><code></code><div><code>  return(corvec)</code></div><code></code><div><code>} # end of function</code></div><code></code><br><div></div><br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-6890" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"><div><div data-permalink="comment-4584" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=6124789"><img src="https://coursera-profile-photos.s3.amazonaws.com/50/2645d087b611e3a1fae537543f7230/meondecember19th2013.jpg" alt="">Patrick McGovern</a><a style="text-decoration: none;" href="https://www.coursera.org/signature/course/rprog/972078?utm_source=spark&amp;utm_medium=forum" target="_blank"><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#comment-4584" name="comment-4584" style="vertical-align:middle"><time title="Tuesday, May 6th 2014, 7:00 pm +03:00" datetime="1399392059">4 hours ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text">-1 for not using variable names I like<br><br><span>[kidding :)]</span></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count course-forum-votes-positive">1</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#comment-4584" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div><div><div class="course-forum-post-container"><div class="course-forum-post-top-container"><div><div data-permalink="post-6906" class="course-forum-post-view-container"><div class="course-forum-post-header"><div class="course-forum-post-controls"></div><h5 class="course-forum-post-byline"><a href="https://class.coursera.org/rprog-002/forum/profile?user_id=238006">James Eibisch</a><span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">· </span><a href="https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-6906" name="post-6906" style="vertical-align:middle"><time title="Tuesday, May 6th 2014, 10:10 pm +03:00" datetime="1399403403">an hour ago</time> <span class="icon-link"></span></a></h5></div><div dir="auto" class="course-forum-post-text">This was mine, very similar to others posted so far:<br><pre><code>corr&lt;-function(directory,threshold=0) {
  id&lt;-list.files(directory,pattern='*.csv',full.names=T)
  v&lt;-vector('numeric')
  for (i in id) {
    d&lt;-read.csv(i)
    if(sum(complete.cases(d))&gt;threshold) {
      d&lt;-d[complete.cases(d),]
      v&lt;-c(v,cor(d$sulfate,d$nitrate))
    }
  }
  return(v)
}</code></pre><br><br></div><div aria-haspopup="true" aria-expanded="false" data-tooltip="Please use votes to bring attention to thoughtful, helpful posts." data-tooltip-position="down" class="course-forum-post-vote-controls"><div tabindex="0" aria-label="Vote this post up." data-direction-value="1" role="button" class="course-forum-post-vote-button course-forum-post-vote-up course-forum-vote-inactive"><i class="icon-arrow-up"></i></div><span class="course-forum-post-vote-count">0</span><span class="accessible-text-for-reader">votes received.</span><div tabindex="0" aria-label="Vote this post down." data-direction-value="-1" role="button" class="course-forum-post-vote-button course-forum-post-vote-down course-forum-vote-inactive"><i class="icon-arrow-down"></i></div></div><a href="https://class.coursera.org/rprog-002/help/flag?url=https://class.coursera.org/rprog-002/forum/thread?thread_id=1175#post-6906" target="_blank" class="course-forum-post-controls-report">·
flag</a><div style="clear: both; height: 3px;"></div></div></div></div><div class="course-forum-comments-container"></div><div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div></div></div>